<metro:MetroWindow x:Class="coffee_cooling.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:coffee_cooling"
        xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
        xmlns:dragablz="clr-namespace:Dragablz;assembly=Dragablz"
        xmlns:metro="http://metro.mahapps.com/winfx/xaml/controls"
        xmlns:dockablz="clr-namespace:Dragablz.Dockablz;assembly=Dragablz"
        xmlns:wpf="http://materialdesigninxaml.net/winfx/xaml/themes"
        mc:Ignorable="d"
        Title="Модель остывания кофе" Height="800" Width="1200"
        GlowBrush="{DynamicResource AccentColorBrush}"
        BorderThickness="1">
    <dragablz:TabablzControl ConsolidateOrphanedItems="True">
        <dragablz:TabablzControl.InterTabController>
            <dragablz:InterTabController />
        </dragablz:TabablzControl.InterTabController>
        <TabItem Header="ГРАФИК">
            <Grid ShowGridLines="False">
                <Grid.RowDefinitions>
                    <RowDefinition Height="50"></RowDefinition>
                    <RowDefinition Height="30"></RowDefinition>
                    <RowDefinition Height="30"></RowDefinition>
                    <RowDefinition Height="30"></RowDefinition>
                    <RowDefinition Height="30"></RowDefinition>
                    <RowDefinition Height="100"></RowDefinition>
                    <RowDefinition></RowDefinition>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="150"></ColumnDefinition>
                    <ColumnDefinition Width="60"></ColumnDefinition>
                    <ColumnDefinition></ColumnDefinition>
                </Grid.ColumnDefinitions>

                <Grid.Resources>
                    <local:OpacityConverter x:Key="OpacityConverter"></local:OpacityConverter>
                </Grid.Resources>

                <Label x:Name="AmbientTempLbl" Content="Комнатная температура" HorizontalAlignment="Right" VerticalAlignment="Top" Grid.Row="1" Grid.Column="0"/>
                <TextBox x:Name="AmbientTempTB" Grid.Column="1" HorizontalAlignment="Center" Height="23" Grid.Row="1" TextWrapping="Wrap" Text="25" VerticalAlignment="Top" Width="50" PreviewTextInput="DoubleTBPreviewTextInput" TextChanged="TB_TextChanged" PreviewKeyDown="TB_PreviewKeyDown" />
                <Label x:Name="StartTempLbl" Content="Начальная температура" HorizontalAlignment="Right" VerticalAlignment="Top" Grid.Row="2" Grid.Column="0"/>
                <TextBox x:Name="StartTempTB" Grid.Column="1" HorizontalAlignment="Center" Height="23" Grid.Row="2" TextWrapping="Wrap" Text="80" VerticalAlignment="Top" Width="50" PreviewTextInput="DoubleTBPreviewTextInput" TextChanged="TB_TextChanged" PreviewKeyDown="TB_PreviewKeyDown"/>
                <Label x:Name="CoolingCoefficientLbl" Content="Коэффициент остывания" HorizontalAlignment="Right" VerticalAlignment="Top" Grid.Row="3" Grid.Column="0"/>
                <TextBox x:Name="CoolingCoefficientTB" Grid.Column="1" HorizontalAlignment="Center" Height="23" Grid.Row="3" TextWrapping="Wrap" Text="0,1" VerticalAlignment="Top" Width="50" PreviewTextInput="DoubleTBPreviewTextInput" TextChanged="TB_TextChanged" PreviewKeyDown="TB_PreviewKeyDown"/>
                <Label x:Name="TimeRangeLbl" Content="Временной период" HorizontalAlignment="Right" VerticalAlignment="Top" Grid.Row="4" Grid.Column="0"/>
                <TextBox x:Name="TimeRangeTB" Grid.Column="1" HorizontalAlignment="Center" Height="23" Grid.Row="4" TextWrapping="Wrap" Text="30" VerticalAlignment="Top" Width="50" PreviewTextInput="DoubleTBPreviewTextInput" TextChanged="TB_TextChanged" PreviewKeyDown="TB_PreviewKeyDown"/>
                <Label x:Name="SegmentCountLbl" Content="Количество точек" HorizontalAlignment="Right" VerticalAlignment="Top" Grid.Row="5" Grid.Column="0"/>
                <TextBox x:Name="SegmentCountTB" Grid.Column="1" HorizontalAlignment="Center" Height="23" Grid.Row="5" TextWrapping="Wrap" Text="30" VerticalAlignment="Top" Width="50" PreviewTextInput="IntTB_PreviewTextInput" TextChanged="TB_TextChanged" PreviewKeyDown="TB_PreviewKeyDown"/>


                <ListBox Name="ListBox" ItemsSource="{Binding Series}" PreviewMouseDown="ListBox_OnPreviewMouseDown" BorderThickness="0" Background="Transparent" Grid.Column="0" Grid.Row="6" Grid.ColumnSpan="2" HorizontalContentAlignment="Center" HorizontalAlignment="Center" VerticalAlignment="Bottom" VerticalContentAlignment="Center">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding (lvc:LineSeries.Title)}" 
                                           Foreground="{Binding (lvc:LineSeries.Stroke)}"
                                           Opacity="{Binding (lvc:LineSeries.Visibility), Converter={StaticResource OpacityConverter}}"
                                           FontSize="22"/>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                    <ListBox.ItemContainerStyle>
                        <Style TargetType="{x:Type ListBoxItem}">
                            <Setter Property="Background" Value="Transparent" />
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type ListBoxItem}">
                                        <ContentPresenter />
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </ListBox.ItemContainerStyle>
                </ListBox>


                <lvc:CartesianChart Name="Plot" Series="{Binding Series}" Hoverable="False" DataTooltip="{x:Null}" Grid.Column="2" Grid.Row="0" Grid.RowSpan="7" DisableAnimations="True">
                    <lvc:CartesianChart.AxisX>
                        <lvc:Axis IsEnabled="True" Labels="{Binding Labels}" ShowLabels="True" FontSize="14"></lvc:Axis>
                    </lvc:CartesianChart.AxisX>
                    <lvc:CartesianChart.AxisY>
                        <lvc:Axis IsMerged="False" FontSize="14"></lvc:Axis>
                    </lvc:CartesianChart.AxisY>
                </lvc:CartesianChart>
            </Grid>
        </TabItem>
        <TabItem Header="ДАННЫЕ">
            <ListView Name="DataLV" ItemsSource="{Binding Data}">
                <ListView.View>
                    <GridView>
                        <GridView.Columns>
                            <GridViewColumn Header="k" DisplayMemberBinding="{Binding PointNumber}"></GridViewColumn>
                            <GridViewColumn DisplayMemberBinding="{Binding TimePoint}">
                                <GridViewColumnHeader>
                                    <TextBlock>
                                        t<Run BaselineAlignment="Subscript" FontSize="10">k</Run>
                                    </TextBlock>
                                </GridViewColumnHeader>
                            </GridViewColumn>
                            <GridViewColumn DisplayMemberBinding="{Binding AnalyticalSolutionVal}">
                                <GridViewColumnHeader>
                                    <TextBlock>
                                        T<Run BaselineAlignment="Subscript" FontSize="10">k</Run><Run BaselineAlignment="Superscript" FontSize="10">теор</Run>
                                    </TextBlock>
                                </GridViewColumnHeader>
                            </GridViewColumn>
                            <GridViewColumn DisplayMemberBinding="{Binding EulerSolutionVal}">
                                <GridViewColumnHeader>
                                    <TextBlock>
                                        T<Run BaselineAlignment="Subscript" FontSize="10">k</Run><Run BaselineAlignment="Superscript" FontSize="10">Э1</Run>
                                    </TextBlock>
                                </GridViewColumnHeader>
                            </GridViewColumn>
                            <GridViewColumn DisplayMemberBinding="{Binding EulerErrorVal}">
                                <GridViewColumnHeader>
                                    <TextBlock>
                                        &#x03B5;<Run BaselineAlignment="Subscript" FontSize="10">k</Run><Run BaselineAlignment="Superscript" FontSize="10">Э1</Run>
                                    </TextBlock>
                                </GridViewColumnHeader>
                            </GridViewColumn>
                            <GridViewColumn DisplayMemberBinding="{Binding MEulerSolutionVal}">
                                <GridViewColumnHeader>
                                    <TextBlock>
                                        T<Run BaselineAlignment="Subscript" FontSize="10">k</Run><Run BaselineAlignment="Superscript" FontSize="10">Э2</Run>
                                    </TextBlock>
                                </GridViewColumnHeader>
                            </GridViewColumn>
                            <GridViewColumn DisplayMemberBinding="{Binding MEulerErrorVal}">
                                <GridViewColumnHeader>
                                    <TextBlock>
                                        &#x03B5;<Run BaselineAlignment="Subscript" FontSize="10">k</Run><Run BaselineAlignment="Superscript" FontSize="10">Э2</Run>
                                    </TextBlock>
                                </GridViewColumnHeader>
                            </GridViewColumn>
                            <GridViewColumn DisplayMemberBinding="{Binding RK4SolutionVal}">
                                <GridViewColumnHeader>
                                    <TextBlock>
                                        T<Run BaselineAlignment="Subscript" FontSize="10">k</Run><Run BaselineAlignment="Superscript" FontSize="10">РК</Run>
                                    </TextBlock>
                                </GridViewColumnHeader>
                            </GridViewColumn>
                            <GridViewColumn DisplayMemberBinding="{Binding RK4ErrorVal}">
                                <GridViewColumnHeader>
                                    <TextBlock>
                                        &#x03B5;<Run BaselineAlignment="Subscript" FontSize="10">k</Run><Run BaselineAlignment="Superscript" FontSize="10">РК</Run>
                                    </TextBlock>
                                </GridViewColumnHeader>
                            </GridViewColumn>
                        </GridView.Columns>
                    </GridView>
                </ListView.View>
            </ListView>
        </TabItem>
    </dragablz:TabablzControl>
</metro:MetroWindow>
